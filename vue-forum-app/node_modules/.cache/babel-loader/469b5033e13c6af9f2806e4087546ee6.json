{"remainingRequest":"/home/scott/forumApp/vue-forum-app/node_modules/babel-loader/lib/index.js!/home/scott/forumApp/vue-forum-app/node_modules/cache-loader/dist/cjs.js??ref--0-0!/home/scott/forumApp/vue-forum-app/node_modules/vue-loader/lib/index.js??vue-loader-options!/home/scott/forumApp/vue-forum-app/src/components/RegisterForm.vue?vue&type=script&lang=js&","dependencies":[{"path":"/home/scott/forumApp/vue-forum-app/src/components/RegisterForm.vue","mtime":1596398635581},{"path":"/home/scott/forumApp/vue-forum-app/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/scott/forumApp/vue-forum-app/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/home/scott/forumApp/vue-forum-app/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/scott/forumApp/vue-forum-app/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":["import \"core-js/modules/es6.function.name\";\nimport \"regenerator-runtime/runtime\";\nimport _asyncToGenerator from \"/home/scott/forumApp/vue-forum-app/node_modules/@babel/runtime-corejs2/helpers/esm/asyncToGenerator\";\nimport _objectSpread from \"/home/scott/forumApp/vue-forum-app/node_modules/@babel/runtime-corejs2/helpers/esm/objectSpread\";\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\nimport { mapState, mapActions } from 'vuex';\nimport { required, email } from 'vuelidate/lib/validators';\nexport default {\n  data: function data() {\n    return {\n      name: '',\n      email: '',\n      password: '',\n      role: 'user',\n      moderateCategory: '',\n      serverErrorMessage: '',\n      loading: false,\n      loadingCategories: false\n    };\n  },\n  validations: {\n    name: {\n      required: required\n    },\n    email: {\n      required: required,\n      email: email\n    },\n    password: {\n      required: required\n    }\n  },\n  computed: _objectSpread({}, mapState({\n    categories: function categories(state) {\n      return state.categories.all;\n    }\n  }), {\n    roleOptions: function roleOptions() {\n      return [{\n        key: 'user',\n        title: 'User'\n      }, {\n        key: 'moderator',\n        title: 'Moderator'\n      }, {\n        key: 'admin',\n        title: 'Admin'\n      }];\n    },\n    categoryOptions: function categoryOptions() {\n      return this.loadingCategories ? [] : this.categories.map(function (category) {\n        return {\n          key: category.slug,\n          title: category.title\n        };\n      });\n    }\n  }),\n  mounted: function () {\n    var _mounted = _asyncToGenerator(\n    /*#__PURE__*/\n    regeneratorRuntime.mark(function _callee() {\n      return regeneratorRuntime.wrap(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              this.loadingCategories = true;\n              _context.next = 3;\n              return this.loadCategories();\n\n            case 3:\n              this.loadingCategories = false;\n\n              if (this.role === 'moderator') {\n                this.moderateCategory = this.categoryOptions[0].key;\n              }\n\n            case 5:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, _callee, this);\n    }));\n\n    function mounted() {\n      return _mounted.apply(this, arguments);\n    }\n\n    return mounted;\n  }(),\n  watch: {\n    role: function role(_role) {\n      this.moderateCategory = _role === 'moderator' ? this.categoryOptions[0].key : '';\n    }\n  },\n  methods: _objectSpread({}, mapActions(['registerUser', 'loadCategories']), {\n    submit: function () {\n      var _submit = _asyncToGenerator(\n      /*#__PURE__*/\n      regeneratorRuntime.mark(function _callee2() {\n        return regeneratorRuntime.wrap(function _callee2$(_context2) {\n          while (1) {\n            switch (_context2.prev = _context2.next) {\n              case 0:\n                this.$v.$touch();\n\n                if (this.$v.$anyError) {\n                  _context2.next = 14;\n                  break;\n                }\n\n                _context2.prev = 2;\n                this.loading = true;\n                _context2.next = 6;\n                return this.registerUser({\n                  data: {\n                    name: this.name,\n                    email: this.email,\n                    password: this.password,\n                    role: this.role,\n                    moderateCategory: this.moderateCategory\n                  }\n                });\n\n              case 6:\n                this.loading = false;\n                this.$router.push({\n                  name: 'Home'\n                });\n                _context2.next = 14;\n                break;\n\n              case 10:\n                _context2.prev = 10;\n                _context2.t0 = _context2[\"catch\"](2);\n                this.serverErrorMessage = _context2.t0.data.message;\n                this.loading = false;\n\n              case 14:\n              case \"end\":\n                return _context2.stop();\n            }\n          }\n        }, _callee2, this, [[2, 10]]);\n      }));\n\n      function submit() {\n        return _submit.apply(this, arguments);\n      }\n\n      return submit;\n    }()\n  })\n};",{"version":3,"sources":["RegisterForm.vue"],"names":[],"mappings":"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","sourcesContent":["<template>\n  <form\n    class=\"register-form page-form\"\n    @submit.prevent=\"submit\"\n  >\n    <span class=\"error-message\">\n      {{ serverErrorMessage }}\n    </span>\n    <div class=\"field\">\n      <label class=\"label\">\n        Name\n      </label>\n      <base-input\n        v-model=\"name\"\n        :errors=\"$v.name\"\n      />\n    </div>\n    <div class=\"field\">\n      <label class=\"label\">\n        Email\n      </label>\n      <base-input\n        v-model=\"email\"\n        type=\"email\"\n        :errors=\"$v.email\"\n      />\n    </div>\n    <div class=\"field\">\n      <label class=\"label\">\n        Password\n      </label>\n      <base-input\n        v-model=\"password\"\n        type=\"password\"\n        :errors=\"$v.password\"\n      />\n    </div>\n    <div class=\"field\">\n      <label class=\"label\">\n        Role\n      </label>\n      <base-select-input\n        v-model=\"role\"\n        :options=\"roleOptions\"\n      />\n    </div>\n    <div\n      v-if=\"role === 'moderator'\"\n      class=\"field\"\n    >\n      <label class=\"label\">\n        Moderates category\n      </label>\n      <base-select-input\n        v-model=\"moderateCategory\"\n        y-direction=\"above\"\n        :loading-options=\"loadingCategories\"\n        :options=\"categoryOptions\"\n      />\n    </div>\n    <base-button\n      :disabled=\"loading\"\n    >\n      {{ loading ? 'Signing Up...' : 'Sign Up' }}\n    </base-button>\n  </form>\n</template>\n\n<script>\nimport { mapState, mapActions } from 'vuex'\nimport { required, email } from 'vuelidate/lib/validators'\n\nexport default {\n  data () {\n    return {\n      name: '',\n      email: '',\n      password: '',\n      role: 'user',\n      moderateCategory: '',\n      serverErrorMessage: '',\n      loading: false,\n      loadingCategories: false\n    }\n  },\n\n  validations: {\n    name: { required },\n    email: { required, email },\n    password: { required }\n  },\n\n  computed: {\n    ...mapState({\n      categories: state => state.categories.all\n    }),\n\n    roleOptions () {\n      return [\n        { key: 'user', title: 'User' },\n        { key: 'moderator', title: 'Moderator' },\n        { key: 'admin', title: 'Admin' }\n      ]\n    },\n\n    categoryOptions () {\n      return this.loadingCategories\n        ? []\n        : this.categories.map(category => ({\n          key: category.slug,\n          title: category.title\n        }))\n    }\n  },\n\n  async mounted () {\n    this.loadingCategories = true\n    await this.loadCategories()\n    this.loadingCategories = false\n    if (this.role === 'moderator') {\n      this.moderateCategory = this.categoryOptions[0].key\n    }\n  },\n\n  watch: {\n    role (role) {\n      this.moderateCategory = role === 'moderator'\n        ? this.categoryOptions[0].key\n        : ''\n    }\n  },\n\n  methods: {\n    ...mapActions(['registerUser', 'loadCategories']),\n    async submit () {\n      this.$v.$touch()\n      if (!this.$v.$anyError) {\n        try {\n          this.loading = true\n          await this.registerUser({\n            data: {\n              name: this.name,\n              email: this.email,\n              password: this.password,\n              role: this.role,\n              moderateCategory: this.moderateCategory\n            }\n          })\n          this.loading = false\n          this.$router.push({ name: 'Home' })\n        } catch (err) {\n          this.serverErrorMessage = err.data.message\n          this.loading = false\n        }\n      }\n    }\n  }\n}\n</script>\n\n<style lang=\"stylus\" scoped>\n.field\n  margin-bottom: 20px\n\n.label\n  display: block\n  margin-bottom: 3px\n\n.base-button\n  width: 100%\n\n.error-message\n  text-align: center\n  display: block\n  margin-bottom: 10px\n  color: $errorColor\n\n.categories-spinner\n  display: flex\n  justify-content: center\n  align-items: center\n  margin-bottom: 15px\n</style>\n"],"sourceRoot":"src/components"}]}